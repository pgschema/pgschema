{
  "version": "1.0.0",
  "pgschema_version": "0.2.0",
  "created_at": "2025-08-02T12:47:55+08:00",
  "transaction": true,
  "summary": {
    "total": 7,
    "add": 2,
    "change": 2,
    "destroy": 3,
    "by_type": {
      "procedures": {
        "add": 0,
        "change": 0,
        "destroy": 1
      },
      "tables": {
        "add": 1,
        "change": 2,
        "destroy": 2
      },
      "types": {
        "add": 1,
        "change": 0,
        "destroy": 0
      }
    }
  },
  "object_changes": [
    {
      "path": "public.employee_status",
      "type": "types",
      "name": "employee_status",
      "schema": "public",
      "change": {
        "actions": [
          "create"
        ],
        "before": null,
        "after": {
          "enum_values": [
            "active",
            "inactive",
            "terminated"
          ],
          "kind": "ENUM",
          "name": "employee_status",
          "schema": "public"
        }
      }
    },
    {
      "path": "public.employee_status_log",
      "type": "tables",
      "name": "employee_status_log",
      "schema": "public",
      "change": {
        "actions": [
          "create"
        ],
        "before": null,
        "after": {
          "columns": [
            {
              "name": "id",
              "position": 1,
              "data_type": "integer",
              "is_nullable": false,
              "default_value": "nextval('employee_status_log_id_seq'::regclass)"
            },
            {
              "name": "emp_no",
              "position": 2,
              "data_type": "integer",
              "is_nullable": false
            },
            {
              "name": "status",
              "position": 3,
              "data_type": "employee_status",
              "is_nullable": false
            },
            {
              "name": "effective_date",
              "position": 4,
              "data_type": "date",
              "is_nullable": false,
              "default_value": "CURRENT_DATE"
            },
            {
              "name": "notes",
              "position": 5,
              "data_type": "text",
              "is_nullable": true
            }
          ],
          "constraints": {
            "employee_status_log_emp_no_fkey": {
              "schema": "public",
              "table": "employee_status_log",
              "name": "employee_status_log_emp_no_fkey",
              "type": "FOREIGN_KEY",
              "columns": [
                {
                  "name": "emp_no",
                  "position": 1
                }
              ],
              "referenced_schema": "public",
              "referenced_table": "employee",
              "referenced_columns": [
                {
                  "name": "emp_no",
                  "position": 1
                }
              ],
              "delete_rule": "CASCADE",
              "update_rule": "NO ACTION"
            },
            "employee_status_log_pkey": {
              "schema": "public",
              "table": "employee_status_log",
              "name": "employee_status_log_pkey",
              "type": "PRIMARY_KEY",
              "columns": [
                {
                  "name": "id",
                  "position": 1
                }
              ]
            }
          },
          "name": "employee_status_log",
          "schema": "public",
          "type": "BASE_TABLE"
        }
      }
    },
    {
      "path": "public.simple_salary_update",
      "type": "procedures",
      "name": "simple_salary_update",
      "schema": "public",
      "change": {
        "actions": [
          "delete"
        ],
        "before": {
          "arguments": "p_emp_no integer, p_amount integer",
          "language": "plpgsql",
          "name": "simple_salary_update",
          "schema": "public"
        },
        "after": null
      }
    },
    {
      "path": "public.title",
      "type": "tables",
      "name": "title",
      "schema": "public",
      "change": {
        "actions": [
          "delete"
        ],
        "before": {
          "columns": [
            {
              "name": "emp_no",
              "position": 1,
              "data_type": "integer",
              "is_nullable": false,
              "precision": 32,
              "scale": 0
            },
            {
              "name": "title",
              "position": 2,
              "data_type": "text",
              "is_nullable": false
            },
            {
              "name": "from_date",
              "position": 3,
              "data_type": "date",
              "is_nullable": false
            },
            {
              "name": "to_date",
              "position": 4,
              "data_type": "date",
              "is_nullable": true
            }
          ],
          "constraints": {
            "title_emp_no_fkey": {
              "schema": "public",
              "table": "title",
              "name": "title_emp_no_fkey",
              "type": "FOREIGN_KEY",
              "columns": [
                {
                  "name": "emp_no",
                  "position": 1
                }
              ],
              "referenced_schema": "public",
              "referenced_table": "employee",
              "referenced_columns": [
                {
                  "name": "emp_no",
                  "position": 1
                }
              ],
              "delete_rule": "NO ACTION",
              "update_rule": "NO ACTION"
            },
            "title_pkey": {
              "schema": "public",
              "table": "title",
              "name": "title_pkey",
              "type": "PRIMARY_KEY",
              "columns": [
                {
                  "name": "emp_no",
                  "position": 1
                },
                {
                  "name": "title",
                  "position": 2
                },
                {
                  "name": "from_date",
                  "position": 3
                }
              ]
            }
          },
          "name": "title",
          "schema": "public",
          "type": "BASE_TABLE"
        },
        "after": null
      }
    },
    {
      "path": "public.dept_manager",
      "type": "tables",
      "name": "dept_manager",
      "schema": "public",
      "change": {
        "actions": [
          "delete"
        ],
        "before": {
          "columns": [
            {
              "name": "emp_no",
              "position": 1,
              "data_type": "integer",
              "is_nullable": false,
              "precision": 32,
              "scale": 0
            },
            {
              "name": "dept_no",
              "position": 2,
              "data_type": "text",
              "is_nullable": false
            },
            {
              "name": "from_date",
              "position": 3,
              "data_type": "date",
              "is_nullable": false
            },
            {
              "name": "to_date",
              "position": 4,
              "data_type": "date",
              "is_nullable": false
            }
          ],
          "constraints": {
            "dept_manager_dept_no_fkey": {
              "schema": "public",
              "table": "dept_manager",
              "name": "dept_manager_dept_no_fkey",
              "type": "FOREIGN_KEY",
              "columns": [
                {
                  "name": "dept_no",
                  "position": 1
                }
              ],
              "referenced_schema": "public",
              "referenced_table": "department",
              "referenced_columns": [
                {
                  "name": "dept_no",
                  "position": 1
                }
              ],
              "delete_rule": "NO ACTION",
              "update_rule": "NO ACTION"
            },
            "dept_manager_emp_no_fkey": {
              "schema": "public",
              "table": "dept_manager",
              "name": "dept_manager_emp_no_fkey",
              "type": "FOREIGN_KEY",
              "columns": [
                {
                  "name": "emp_no",
                  "position": 1
                }
              ],
              "referenced_schema": "public",
              "referenced_table": "employee",
              "referenced_columns": [
                {
                  "name": "emp_no",
                  "position": 1
                }
              ],
              "delete_rule": "NO ACTION",
              "update_rule": "NO ACTION"
            },
            "dept_manager_pkey": {
              "schema": "public",
              "table": "dept_manager",
              "name": "dept_manager_pkey",
              "type": "PRIMARY_KEY",
              "columns": [
                {
                  "name": "emp_no",
                  "position": 1
                },
                {
                  "name": "dept_no",
                  "position": 2
                }
              ]
            }
          },
          "name": "dept_manager",
          "schema": "public",
          "type": "BASE_TABLE"
        },
        "after": null
      }
    },
    {
      "path": "public.audit",
      "type": "tables",
      "name": "audit",
      "schema": "public",
      "change": {
        "actions": [
          "update"
        ],
        "before": {},
        "after": {
          "columns": [
            {
              "name": "id",
              "position": 1,
              "data_type": "integer",
              "is_nullable": false,
              "default_value": "nextval('audit_id_seq'::regclass)"
            },
            {
              "name": "operation",
              "position": 2,
              "data_type": "text",
              "is_nullable": false
            },
            {
              "name": "query",
              "position": 3,
              "data_type": "text",
              "is_nullable": true
            },
            {
              "name": "user_name",
              "position": 4,
              "data_type": "text",
              "is_nullable": false
            },
            {
              "name": "changed_at",
              "position": 5,
              "data_type": "timestamptz",
              "is_nullable": true,
              "default_value": "CURRENT_TIMESTAMP"
            }
          ],
          "constraints": {
            "audit_pkey": {
              "schema": "public",
              "table": "audit",
              "name": "audit_pkey",
              "type": "PRIMARY_KEY",
              "columns": [
                {
                  "name": "id",
                  "position": 1
                }
              ]
            }
          },
          "name": "audit",
          "schema": "public",
          "type": "BASE_TABLE"
        }
      },
      "metadata": {
        "added_columns": 0,
        "added_constraints": 0,
        "added_indexes": 0,
        "added_policies": 2,
        "added_triggers": 0,
        "dropped_columns": 0,
        "dropped_constraints": 0,
        "dropped_indexes": 0,
        "dropped_policies": 0,
        "dropped_triggers": 0,
        "modified_columns": 0,
        "modified_policies": 0,
        "modified_triggers": 0,
        "rls_changes": 1
      }
    },
    {
      "path": "public.audit.audit_insert_system",
      "type": "policies",
      "name": "audit_insert_system",
      "schema": "public",
      "table": "audit",
      "change": {
        "actions": [
          "create"
        ],
        "before": null,
        "after": {
          "command": "INSERT",
          "name": "audit_insert_system",
          "permissive": true,
          "roles": [
            "PUBLIC"
          ],
          "schema": "public",
          "table": "audit",
          "with_check": "(true)"
        }
      }
    },
    {
      "path": "public.audit.audit_user_isolation",
      "type": "policies",
      "name": "audit_user_isolation",
      "schema": "public",
      "table": "audit",
      "change": {
        "actions": [
          "create"
        ],
        "before": null,
        "after": {
          "command": "ALL",
          "name": "audit_user_isolation",
          "permissive": true,
          "roles": [
            "PUBLIC"
          ],
          "schema": "public",
          "table": "audit",
          "using": "(user_name = CURRENT_USER)"
        }
      }
    },
    {
      "path": "public.audit",
      "type": "rls",
      "name": "row_level_security",
      "schema": "public",
      "table": "audit",
      "change": {
        "actions": [
          "update"
        ],
        "before": {
          "enabled": false
        },
        "after": {
          "enabled": true
        }
      }
    },
    {
      "path": "public.employee",
      "type": "tables",
      "name": "employee",
      "schema": "public",
      "change": {
        "actions": [
          "update"
        ],
        "before": {},
        "after": {
          "columns": [
            {
              "name": "emp_no",
              "position": 1,
              "data_type": "integer",
              "is_nullable": false,
              "default_value": "nextval('employee_emp_no_seq'::regclass)"
            },
            {
              "name": "birth_date",
              "position": 2,
              "data_type": "date",
              "is_nullable": false
            },
            {
              "name": "first_name",
              "position": 3,
              "data_type": "text",
              "is_nullable": false
            },
            {
              "name": "last_name",
              "position": 4,
              "data_type": "text",
              "is_nullable": false
            },
            {
              "name": "gender",
              "position": 5,
              "data_type": "text",
              "is_nullable": false
            },
            {
              "name": "hire_date",
              "position": 6,
              "data_type": "date",
              "is_nullable": false
            },
            {
              "name": "status",
              "position": 7,
              "data_type": "employee_status",
              "is_nullable": false,
              "default_value": "'active'"
            }
          ],
          "constraints": {
            "employee_gender_check": {
              "schema": "public",
              "table": "employee",
              "name": "employee_gender_check",
              "type": "CHECK",
              "columns": [
                {
                  "name": "gender",
                  "position": 0
                }
              ],
              "check_clause": "CHECK (gender IN ('M', 'F'))"
            },
            "employee_pkey": {
              "schema": "public",
              "table": "employee",
              "name": "employee_pkey",
              "type": "PRIMARY_KEY",
              "columns": [
                {
                  "name": "emp_no",
                  "position": 1
                }
              ]
            }
          },
          "name": "employee",
          "schema": "public",
          "type": "BASE_TABLE"
        }
      },
      "metadata": {
        "added_columns": 1,
        "added_constraints": 0,
        "added_indexes": 0,
        "added_policies": 0,
        "added_triggers": 0,
        "dropped_columns": 0,
        "dropped_constraints": 0,
        "dropped_indexes": 0,
        "dropped_policies": 0,
        "dropped_triggers": 0,
        "modified_columns": 0,
        "modified_policies": 0,
        "modified_triggers": 0,
        "rls_changes": 0
      }
    },
    {
      "path": "public.employee.status",
      "type": "columns",
      "name": "status",
      "schema": "public",
      "table": "employee",
      "change": {
        "actions": [
          "create"
        ],
        "before": null,
        "after": {
          "data_type": "employee_status",
          "default_value": "'active'",
          "is_identity": false,
          "is_nullable": false,
          "name": "status",
          "position": 7
        }
      }
    }
  ],
  "steps": [
    {
      "sql": "DROP PROCEDURE IF EXISTS simple_salary_update(integer, integer);",
      "object_type": "procedure",
      "operation": "drop",
      "object_path": "public.simple_salary_update",
      "source_change": {
        "schema": "public",
        "name": "simple_salary_update",
        "definition": "\nBEGIN\n    -- Simple update of salary amount\n    UPDATE salary \n    SET amount = p_amount \n    WHERE emp_no = p_emp_no \n    AND to_date = '9999-01-01';\n    \n    RAISE NOTICE 'Updated salary for employee % to $%', p_emp_no, p_amount;\nEND;\n",
        "language": "plpgsql",
        "arguments": "p_emp_no integer, p_amount integer"
      }
    },
    {
      "sql": "DROP TABLE IF EXISTS title CASCADE;",
      "object_type": "table",
      "operation": "drop",
      "object_path": "public.title",
      "source_change": {
        "schema": "public",
        "name": "title",
        "type": "BASE_TABLE",
        "columns": [
          {
            "name": "emp_no",
            "position": 1,
            "data_type": "integer",
            "is_nullable": false,
            "precision": 32,
            "scale": 0
          },
          {
            "name": "title",
            "position": 2,
            "data_type": "text",
            "is_nullable": false
          },
          {
            "name": "from_date",
            "position": 3,
            "data_type": "date",
            "is_nullable": false
          },
          {
            "name": "to_date",
            "position": 4,
            "data_type": "date",
            "is_nullable": true
          }
        ],
        "constraints": {
          "title_emp_no_fkey": {
            "schema": "public",
            "table": "title",
            "name": "title_emp_no_fkey",
            "type": "FOREIGN_KEY",
            "columns": [
              {
                "name": "emp_no",
                "position": 1
              }
            ],
            "referenced_schema": "public",
            "referenced_table": "employee",
            "referenced_columns": [
              {
                "name": "emp_no",
                "position": 1
              }
            ],
            "delete_rule": "NO ACTION",
            "update_rule": "NO ACTION"
          },
          "title_pkey": {
            "schema": "public",
            "table": "title",
            "name": "title_pkey",
            "type": "PRIMARY_KEY",
            "columns": [
              {
                "name": "emp_no",
                "position": 1
              },
              {
                "name": "title",
                "position": 2
              },
              {
                "name": "from_date",
                "position": 3
              }
            ]
          }
        },
        "indexes": {},
        "triggers": {},
        "rls_enabled": false,
        "policies": {},
        "dependencies": null,
        "is_partitioned": false
      }
    },
    {
      "sql": "DROP TABLE IF EXISTS dept_manager CASCADE;",
      "object_type": "table",
      "operation": "drop",
      "object_path": "public.dept_manager",
      "source_change": {
        "schema": "public",
        "name": "dept_manager",
        "type": "BASE_TABLE",
        "columns": [
          {
            "name": "emp_no",
            "position": 1,
            "data_type": "integer",
            "is_nullable": false,
            "precision": 32,
            "scale": 0
          },
          {
            "name": "dept_no",
            "position": 2,
            "data_type": "text",
            "is_nullable": false
          },
          {
            "name": "from_date",
            "position": 3,
            "data_type": "date",
            "is_nullable": false
          },
          {
            "name": "to_date",
            "position": 4,
            "data_type": "date",
            "is_nullable": false
          }
        ],
        "constraints": {
          "dept_manager_dept_no_fkey": {
            "schema": "public",
            "table": "dept_manager",
            "name": "dept_manager_dept_no_fkey",
            "type": "FOREIGN_KEY",
            "columns": [
              {
                "name": "dept_no",
                "position": 1
              }
            ],
            "referenced_schema": "public",
            "referenced_table": "department",
            "referenced_columns": [
              {
                "name": "dept_no",
                "position": 1
              }
            ],
            "delete_rule": "NO ACTION",
            "update_rule": "NO ACTION"
          },
          "dept_manager_emp_no_fkey": {
            "schema": "public",
            "table": "dept_manager",
            "name": "dept_manager_emp_no_fkey",
            "type": "FOREIGN_KEY",
            "columns": [
              {
                "name": "emp_no",
                "position": 1
              }
            ],
            "referenced_schema": "public",
            "referenced_table": "employee",
            "referenced_columns": [
              {
                "name": "emp_no",
                "position": 1
              }
            ],
            "delete_rule": "NO ACTION",
            "update_rule": "NO ACTION"
          },
          "dept_manager_pkey": {
            "schema": "public",
            "table": "dept_manager",
            "name": "dept_manager_pkey",
            "type": "PRIMARY_KEY",
            "columns": [
              {
                "name": "emp_no",
                "position": 1
              },
              {
                "name": "dept_no",
                "position": 2
              }
            ]
          }
        },
        "indexes": {},
        "triggers": {},
        "rls_enabled": false,
        "policies": {},
        "dependencies": null,
        "is_partitioned": false
      }
    },
    {
      "sql": "CREATE TYPE employee_status AS ENUM (\n    'active',\n    'inactive',\n    'terminated'\n);",
      "object_type": "type",
      "operation": "create",
      "object_path": "public.employee_status",
      "source_change": {
        "schema": "public",
        "name": "employee_status",
        "kind": "ENUM",
        "enum_values": [
          "active",
          "inactive",
          "terminated"
        ]
      }
    },
    {
      "sql": "CREATE TABLE IF NOT EXISTS employee_status_log (\n    id SERIAL PRIMARY KEY,\n    emp_no integer NOT NULL REFERENCES employee(emp_no) ON DELETE CASCADE,\n    status employee_status NOT NULL,\n    effective_date date DEFAULT CURRENT_DATE NOT NULL,\n    notes text\n);",
      "object_type": "table",
      "operation": "create",
      "object_path": "public.employee_status_log",
      "source_change": {
        "schema": "public",
        "name": "employee_status_log",
        "type": "BASE_TABLE",
        "columns": [
          {
            "name": "id",
            "position": 1,
            "data_type": "integer",
            "is_nullable": false,
            "default_value": "nextval('employee_status_log_id_seq'::regclass)"
          },
          {
            "name": "emp_no",
            "position": 2,
            "data_type": "integer",
            "is_nullable": false
          },
          {
            "name": "status",
            "position": 3,
            "data_type": "employee_status",
            "is_nullable": false
          },
          {
            "name": "effective_date",
            "position": 4,
            "data_type": "date",
            "is_nullable": false,
            "default_value": "CURRENT_DATE"
          },
          {
            "name": "notes",
            "position": 5,
            "data_type": "text",
            "is_nullable": true
          }
        ],
        "constraints": {
          "employee_status_log_emp_no_fkey": {
            "schema": "public",
            "table": "employee_status_log",
            "name": "employee_status_log_emp_no_fkey",
            "type": "FOREIGN_KEY",
            "columns": [
              {
                "name": "emp_no",
                "position": 1
              }
            ],
            "referenced_schema": "public",
            "referenced_table": "employee",
            "referenced_columns": [
              {
                "name": "emp_no",
                "position": 1
              }
            ],
            "delete_rule": "CASCADE",
            "update_rule": "NO ACTION"
          },
          "employee_status_log_pkey": {
            "schema": "public",
            "table": "employee_status_log",
            "name": "employee_status_log_pkey",
            "type": "PRIMARY_KEY",
            "columns": [
              {
                "name": "id",
                "position": 1
              }
            ]
          }
        },
        "indexes": {
          "idx_employee_status_log_effective_date": {
            "schema": "public",
            "table": "employee_status_log",
            "name": "idx_employee_status_log_effective_date",
            "type": "REGULAR",
            "method": "btree",
            "columns": [
              {
                "name": "effective_date",
                "position": 1,
                "direction": "ASC"
              }
            ],
            "is_concurrent": false,
            "is_partial": false,
            "is_expression": false
          },
          "idx_employee_status_log_emp_no": {
            "schema": "public",
            "table": "employee_status_log",
            "name": "idx_employee_status_log_emp_no",
            "type": "REGULAR",
            "method": "btree",
            "columns": [
              {
                "name": "emp_no",
                "position": 1,
                "direction": "ASC"
              }
            ],
            "is_concurrent": false,
            "is_partial": false,
            "is_expression": false
          }
        },
        "triggers": {},
        "rls_enabled": false,
        "policies": {},
        "dependencies": null,
        "is_partitioned": false
      }
    },
    {
      "sql": "CREATE INDEX IF NOT EXISTS idx_employee_status_log_effective_date ON employee_status_log (effective_date);",
      "object_type": "index",
      "operation": "create",
      "object_path": "public.idx_employee_status_log_effective_date",
      "source_change": {
        "schema": "public",
        "table": "employee_status_log",
        "name": "idx_employee_status_log_effective_date",
        "type": "REGULAR",
        "method": "btree",
        "columns": [
          {
            "name": "effective_date",
            "position": 1,
            "direction": "ASC"
          }
        ],
        "is_concurrent": false,
        "is_partial": false,
        "is_expression": false
      }
    },
    {
      "sql": "CREATE INDEX IF NOT EXISTS idx_employee_status_log_emp_no ON employee_status_log (emp_no);",
      "object_type": "index",
      "operation": "create",
      "object_path": "public.idx_employee_status_log_emp_no",
      "source_change": {
        "schema": "public",
        "table": "employee_status_log",
        "name": "idx_employee_status_log_emp_no",
        "type": "REGULAR",
        "method": "btree",
        "columns": [
          {
            "name": "emp_no",
            "position": 1,
            "direction": "ASC"
          }
        ],
        "is_concurrent": false,
        "is_partial": false,
        "is_expression": false
      }
    },
    {
      "sql": "ALTER TABLE audit ENABLE ROW LEVEL SECURITY;",
      "object_type": "table",
      "operation": "alter",
      "object_path": "public.audit",
      "source_change": {
        "Table": {
          "schema": "public",
          "name": "audit",
          "type": "BASE_TABLE",
          "columns": [
            {
              "name": "id",
              "position": 1,
              "data_type": "integer",
              "is_nullable": false,
              "default_value": "nextval('audit_id_seq'::regclass)"
            },
            {
              "name": "operation",
              "position": 2,
              "data_type": "text",
              "is_nullable": false
            },
            {
              "name": "query",
              "position": 3,
              "data_type": "text",
              "is_nullable": true
            },
            {
              "name": "user_name",
              "position": 4,
              "data_type": "text",
              "is_nullable": false
            },
            {
              "name": "changed_at",
              "position": 5,
              "data_type": "timestamptz",
              "is_nullable": true,
              "default_value": "CURRENT_TIMESTAMP"
            }
          ],
          "constraints": {
            "audit_pkey": {
              "schema": "public",
              "table": "audit",
              "name": "audit_pkey",
              "type": "PRIMARY_KEY",
              "columns": [
                {
                  "name": "id",
                  "position": 1
                }
              ]
            }
          },
          "indexes": {
            "idx_audit_changed_at": {
              "schema": "public",
              "table": "audit",
              "name": "idx_audit_changed_at",
              "type": "REGULAR",
              "method": "btree",
              "columns": [
                {
                  "name": "changed_at",
                  "position": 1,
                  "direction": "ASC"
                }
              ],
              "is_concurrent": false,
              "is_partial": false,
              "is_expression": false
            },
            "idx_audit_operation": {
              "schema": "public",
              "table": "audit",
              "name": "idx_audit_operation",
              "type": "REGULAR",
              "method": "btree",
              "columns": [
                {
                  "name": "operation",
                  "position": 1,
                  "direction": "ASC"
                }
              ],
              "is_concurrent": false,
              "is_partial": false,
              "is_expression": false
            },
            "idx_audit_username": {
              "schema": "public",
              "table": "audit",
              "name": "idx_audit_username",
              "type": "REGULAR",
              "method": "btree",
              "columns": [
                {
                  "name": "user_name",
                  "position": 1,
                  "direction": "ASC"
                }
              ],
              "is_concurrent": false,
              "is_partial": false,
              "is_expression": false
            }
          },
          "triggers": {},
          "rls_enabled": true,
          "policies": {
            "audit_insert_system": {
              "schema": "public",
              "table": "audit",
              "name": "audit_insert_system",
              "command": "INSERT",
              "permissive": true,
              "roles": [
                "PUBLIC"
              ],
              "with_check": "(true)"
            },
            "audit_user_isolation": {
              "schema": "public",
              "table": "audit",
              "name": "audit_user_isolation",
              "command": "ALL",
              "permissive": true,
              "roles": [
                "PUBLIC"
              ],
              "using": "(user_name = CURRENT_USER)"
            }
          },
          "dependencies": null,
          "is_partitioned": false
        },
        "AddedColumns": [],
        "DroppedColumns": [],
        "ModifiedColumns": [],
        "AddedConstraints": [],
        "DroppedConstraints": [],
        "AddedIndexes": [],
        "DroppedIndexes": [],
        "ModifiedIndexes": [],
        "AddedTriggers": [],
        "DroppedTriggers": [],
        "ModifiedTriggers": [],
        "AddedPolicies": [
          {
            "schema": "public",
            "table": "audit",
            "name": "audit_insert_system",
            "command": "INSERT",
            "permissive": true,
            "roles": [
              "PUBLIC"
            ],
            "with_check": "(true)"
          },
          {
            "schema": "public",
            "table": "audit",
            "name": "audit_user_isolation",
            "command": "ALL",
            "permissive": true,
            "roles": [
              "PUBLIC"
            ],
            "using": "(user_name = CURRENT_USER)"
          }
        ],
        "DroppedPolicies": [],
        "ModifiedPolicies": [],
        "RLSChanges": [
          {
            "Table": {
              "schema": "public",
              "name": "audit",
              "type": "BASE_TABLE",
              "columns": [
                {
                  "name": "id",
                  "position": 1,
                  "data_type": "integer",
                  "is_nullable": false,
                  "default_value": "nextval('audit_id_seq'::regclass)"
                },
                {
                  "name": "operation",
                  "position": 2,
                  "data_type": "text",
                  "is_nullable": false
                },
                {
                  "name": "query",
                  "position": 3,
                  "data_type": "text",
                  "is_nullable": true
                },
                {
                  "name": "user_name",
                  "position": 4,
                  "data_type": "text",
                  "is_nullable": false
                },
                {
                  "name": "changed_at",
                  "position": 5,
                  "data_type": "timestamptz",
                  "is_nullable": true,
                  "default_value": "CURRENT_TIMESTAMP"
                }
              ],
              "constraints": {
                "audit_pkey": {
                  "schema": "public",
                  "table": "audit",
                  "name": "audit_pkey",
                  "type": "PRIMARY_KEY",
                  "columns": [
                    {
                      "name": "id",
                      "position": 1
                    }
                  ]
                }
              },
              "indexes": {
                "idx_audit_changed_at": {
                  "schema": "public",
                  "table": "audit",
                  "name": "idx_audit_changed_at",
                  "type": "REGULAR",
                  "method": "btree",
                  "columns": [
                    {
                      "name": "changed_at",
                      "position": 1,
                      "direction": "ASC"
                    }
                  ],
                  "is_concurrent": false,
                  "is_partial": false,
                  "is_expression": false
                },
                "idx_audit_operation": {
                  "schema": "public",
                  "table": "audit",
                  "name": "idx_audit_operation",
                  "type": "REGULAR",
                  "method": "btree",
                  "columns": [
                    {
                      "name": "operation",
                      "position": 1,
                      "direction": "ASC"
                    }
                  ],
                  "is_concurrent": false,
                  "is_partial": false,
                  "is_expression": false
                },
                "idx_audit_username": {
                  "schema": "public",
                  "table": "audit",
                  "name": "idx_audit_username",
                  "type": "REGULAR",
                  "method": "btree",
                  "columns": [
                    {
                      "name": "user_name",
                      "position": 1,
                      "direction": "ASC"
                    }
                  ],
                  "is_concurrent": false,
                  "is_partial": false,
                  "is_expression": false
                }
              },
              "triggers": {},
              "rls_enabled": true,
              "policies": {
                "audit_insert_system": {
                  "schema": "public",
                  "table": "audit",
                  "name": "audit_insert_system",
                  "command": "INSERT",
                  "permissive": true,
                  "roles": [
                    "PUBLIC"
                  ],
                  "with_check": "(true)"
                },
                "audit_user_isolation": {
                  "schema": "public",
                  "table": "audit",
                  "name": "audit_user_isolation",
                  "command": "ALL",
                  "permissive": true,
                  "roles": [
                    "PUBLIC"
                  ],
                  "using": "(user_name = CURRENT_USER)"
                }
              },
              "dependencies": null,
              "is_partitioned": false
            },
            "Enabled": true
          }
        ],
        "CommentChanged": false,
        "OldComment": "",
        "NewComment": ""
      }
    },
    {
      "sql": "CREATE POLICY audit_insert_system ON audit FOR INSERT TO PUBLIC WITH CHECK (true);",
      "object_type": "table",
      "operation": "alter",
      "object_path": "public.audit",
      "source_change": {
        "Table": {
          "schema": "public",
          "name": "audit",
          "type": "BASE_TABLE",
          "columns": [
            {
              "name": "id",
              "position": 1,
              "data_type": "integer",
              "is_nullable": false,
              "default_value": "nextval('audit_id_seq'::regclass)"
            },
            {
              "name": "operation",
              "position": 2,
              "data_type": "text",
              "is_nullable": false
            },
            {
              "name": "query",
              "position": 3,
              "data_type": "text",
              "is_nullable": true
            },
            {
              "name": "user_name",
              "position": 4,
              "data_type": "text",
              "is_nullable": false
            },
            {
              "name": "changed_at",
              "position": 5,
              "data_type": "timestamptz",
              "is_nullable": true,
              "default_value": "CURRENT_TIMESTAMP"
            }
          ],
          "constraints": {
            "audit_pkey": {
              "schema": "public",
              "table": "audit",
              "name": "audit_pkey",
              "type": "PRIMARY_KEY",
              "columns": [
                {
                  "name": "id",
                  "position": 1
                }
              ]
            }
          },
          "indexes": {
            "idx_audit_changed_at": {
              "schema": "public",
              "table": "audit",
              "name": "idx_audit_changed_at",
              "type": "REGULAR",
              "method": "btree",
              "columns": [
                {
                  "name": "changed_at",
                  "position": 1,
                  "direction": "ASC"
                }
              ],
              "is_concurrent": false,
              "is_partial": false,
              "is_expression": false
            },
            "idx_audit_operation": {
              "schema": "public",
              "table": "audit",
              "name": "idx_audit_operation",
              "type": "REGULAR",
              "method": "btree",
              "columns": [
                {
                  "name": "operation",
                  "position": 1,
                  "direction": "ASC"
                }
              ],
              "is_concurrent": false,
              "is_partial": false,
              "is_expression": false
            },
            "idx_audit_username": {
              "schema": "public",
              "table": "audit",
              "name": "idx_audit_username",
              "type": "REGULAR",
              "method": "btree",
              "columns": [
                {
                  "name": "user_name",
                  "position": 1,
                  "direction": "ASC"
                }
              ],
              "is_concurrent": false,
              "is_partial": false,
              "is_expression": false
            }
          },
          "triggers": {},
          "rls_enabled": true,
          "policies": {
            "audit_insert_system": {
              "schema": "public",
              "table": "audit",
              "name": "audit_insert_system",
              "command": "INSERT",
              "permissive": true,
              "roles": [
                "PUBLIC"
              ],
              "with_check": "(true)"
            },
            "audit_user_isolation": {
              "schema": "public",
              "table": "audit",
              "name": "audit_user_isolation",
              "command": "ALL",
              "permissive": true,
              "roles": [
                "PUBLIC"
              ],
              "using": "(user_name = CURRENT_USER)"
            }
          },
          "dependencies": null,
          "is_partitioned": false
        },
        "AddedColumns": [],
        "DroppedColumns": [],
        "ModifiedColumns": [],
        "AddedConstraints": [],
        "DroppedConstraints": [],
        "AddedIndexes": [],
        "DroppedIndexes": [],
        "ModifiedIndexes": [],
        "AddedTriggers": [],
        "DroppedTriggers": [],
        "ModifiedTriggers": [],
        "AddedPolicies": [
          {
            "schema": "public",
            "table": "audit",
            "name": "audit_insert_system",
            "command": "INSERT",
            "permissive": true,
            "roles": [
              "PUBLIC"
            ],
            "with_check": "(true)"
          },
          {
            "schema": "public",
            "table": "audit",
            "name": "audit_user_isolation",
            "command": "ALL",
            "permissive": true,
            "roles": [
              "PUBLIC"
            ],
            "using": "(user_name = CURRENT_USER)"
          }
        ],
        "DroppedPolicies": [],
        "ModifiedPolicies": [],
        "RLSChanges": [
          {
            "Table": {
              "schema": "public",
              "name": "audit",
              "type": "BASE_TABLE",
              "columns": [
                {
                  "name": "id",
                  "position": 1,
                  "data_type": "integer",
                  "is_nullable": false,
                  "default_value": "nextval('audit_id_seq'::regclass)"
                },
                {
                  "name": "operation",
                  "position": 2,
                  "data_type": "text",
                  "is_nullable": false
                },
                {
                  "name": "query",
                  "position": 3,
                  "data_type": "text",
                  "is_nullable": true
                },
                {
                  "name": "user_name",
                  "position": 4,
                  "data_type": "text",
                  "is_nullable": false
                },
                {
                  "name": "changed_at",
                  "position": 5,
                  "data_type": "timestamptz",
                  "is_nullable": true,
                  "default_value": "CURRENT_TIMESTAMP"
                }
              ],
              "constraints": {
                "audit_pkey": {
                  "schema": "public",
                  "table": "audit",
                  "name": "audit_pkey",
                  "type": "PRIMARY_KEY",
                  "columns": [
                    {
                      "name": "id",
                      "position": 1
                    }
                  ]
                }
              },
              "indexes": {
                "idx_audit_changed_at": {
                  "schema": "public",
                  "table": "audit",
                  "name": "idx_audit_changed_at",
                  "type": "REGULAR",
                  "method": "btree",
                  "columns": [
                    {
                      "name": "changed_at",
                      "position": 1,
                      "direction": "ASC"
                    }
                  ],
                  "is_concurrent": false,
                  "is_partial": false,
                  "is_expression": false
                },
                "idx_audit_operation": {
                  "schema": "public",
                  "table": "audit",
                  "name": "idx_audit_operation",
                  "type": "REGULAR",
                  "method": "btree",
                  "columns": [
                    {
                      "name": "operation",
                      "position": 1,
                      "direction": "ASC"
                    }
                  ],
                  "is_concurrent": false,
                  "is_partial": false,
                  "is_expression": false
                },
                "idx_audit_username": {
                  "schema": "public",
                  "table": "audit",
                  "name": "idx_audit_username",
                  "type": "REGULAR",
                  "method": "btree",
                  "columns": [
                    {
                      "name": "user_name",
                      "position": 1,
                      "direction": "ASC"
                    }
                  ],
                  "is_concurrent": false,
                  "is_partial": false,
                  "is_expression": false
                }
              },
              "triggers": {},
              "rls_enabled": true,
              "policies": {
                "audit_insert_system": {
                  "schema": "public",
                  "table": "audit",
                  "name": "audit_insert_system",
                  "command": "INSERT",
                  "permissive": true,
                  "roles": [
                    "PUBLIC"
                  ],
                  "with_check": "(true)"
                },
                "audit_user_isolation": {
                  "schema": "public",
                  "table": "audit",
                  "name": "audit_user_isolation",
                  "command": "ALL",
                  "permissive": true,
                  "roles": [
                    "PUBLIC"
                  ],
                  "using": "(user_name = CURRENT_USER)"
                }
              },
              "dependencies": null,
              "is_partitioned": false
            },
            "Enabled": true
          }
        ],
        "CommentChanged": false,
        "OldComment": "",
        "NewComment": ""
      }
    },
    {
      "sql": "CREATE POLICY audit_user_isolation ON audit TO PUBLIC USING (user_name = CURRENT_USER);",
      "object_type": "table",
      "operation": "alter",
      "object_path": "public.audit",
      "source_change": {
        "Table": {
          "schema": "public",
          "name": "audit",
          "type": "BASE_TABLE",
          "columns": [
            {
              "name": "id",
              "position": 1,
              "data_type": "integer",
              "is_nullable": false,
              "default_value": "nextval('audit_id_seq'::regclass)"
            },
            {
              "name": "operation",
              "position": 2,
              "data_type": "text",
              "is_nullable": false
            },
            {
              "name": "query",
              "position": 3,
              "data_type": "text",
              "is_nullable": true
            },
            {
              "name": "user_name",
              "position": 4,
              "data_type": "text",
              "is_nullable": false
            },
            {
              "name": "changed_at",
              "position": 5,
              "data_type": "timestamptz",
              "is_nullable": true,
              "default_value": "CURRENT_TIMESTAMP"
            }
          ],
          "constraints": {
            "audit_pkey": {
              "schema": "public",
              "table": "audit",
              "name": "audit_pkey",
              "type": "PRIMARY_KEY",
              "columns": [
                {
                  "name": "id",
                  "position": 1
                }
              ]
            }
          },
          "indexes": {
            "idx_audit_changed_at": {
              "schema": "public",
              "table": "audit",
              "name": "idx_audit_changed_at",
              "type": "REGULAR",
              "method": "btree",
              "columns": [
                {
                  "name": "changed_at",
                  "position": 1,
                  "direction": "ASC"
                }
              ],
              "is_concurrent": false,
              "is_partial": false,
              "is_expression": false
            },
            "idx_audit_operation": {
              "schema": "public",
              "table": "audit",
              "name": "idx_audit_operation",
              "type": "REGULAR",
              "method": "btree",
              "columns": [
                {
                  "name": "operation",
                  "position": 1,
                  "direction": "ASC"
                }
              ],
              "is_concurrent": false,
              "is_partial": false,
              "is_expression": false
            },
            "idx_audit_username": {
              "schema": "public",
              "table": "audit",
              "name": "idx_audit_username",
              "type": "REGULAR",
              "method": "btree",
              "columns": [
                {
                  "name": "user_name",
                  "position": 1,
                  "direction": "ASC"
                }
              ],
              "is_concurrent": false,
              "is_partial": false,
              "is_expression": false
            }
          },
          "triggers": {},
          "rls_enabled": true,
          "policies": {
            "audit_insert_system": {
              "schema": "public",
              "table": "audit",
              "name": "audit_insert_system",
              "command": "INSERT",
              "permissive": true,
              "roles": [
                "PUBLIC"
              ],
              "with_check": "(true)"
            },
            "audit_user_isolation": {
              "schema": "public",
              "table": "audit",
              "name": "audit_user_isolation",
              "command": "ALL",
              "permissive": true,
              "roles": [
                "PUBLIC"
              ],
              "using": "(user_name = CURRENT_USER)"
            }
          },
          "dependencies": null,
          "is_partitioned": false
        },
        "AddedColumns": [],
        "DroppedColumns": [],
        "ModifiedColumns": [],
        "AddedConstraints": [],
        "DroppedConstraints": [],
        "AddedIndexes": [],
        "DroppedIndexes": [],
        "ModifiedIndexes": [],
        "AddedTriggers": [],
        "DroppedTriggers": [],
        "ModifiedTriggers": [],
        "AddedPolicies": [
          {
            "schema": "public",
            "table": "audit",
            "name": "audit_insert_system",
            "command": "INSERT",
            "permissive": true,
            "roles": [
              "PUBLIC"
            ],
            "with_check": "(true)"
          },
          {
            "schema": "public",
            "table": "audit",
            "name": "audit_user_isolation",
            "command": "ALL",
            "permissive": true,
            "roles": [
              "PUBLIC"
            ],
            "using": "(user_name = CURRENT_USER)"
          }
        ],
        "DroppedPolicies": [],
        "ModifiedPolicies": [],
        "RLSChanges": [
          {
            "Table": {
              "schema": "public",
              "name": "audit",
              "type": "BASE_TABLE",
              "columns": [
                {
                  "name": "id",
                  "position": 1,
                  "data_type": "integer",
                  "is_nullable": false,
                  "default_value": "nextval('audit_id_seq'::regclass)"
                },
                {
                  "name": "operation",
                  "position": 2,
                  "data_type": "text",
                  "is_nullable": false
                },
                {
                  "name": "query",
                  "position": 3,
                  "data_type": "text",
                  "is_nullable": true
                },
                {
                  "name": "user_name",
                  "position": 4,
                  "data_type": "text",
                  "is_nullable": false
                },
                {
                  "name": "changed_at",
                  "position": 5,
                  "data_type": "timestamptz",
                  "is_nullable": true,
                  "default_value": "CURRENT_TIMESTAMP"
                }
              ],
              "constraints": {
                "audit_pkey": {
                  "schema": "public",
                  "table": "audit",
                  "name": "audit_pkey",
                  "type": "PRIMARY_KEY",
                  "columns": [
                    {
                      "name": "id",
                      "position": 1
                    }
                  ]
                }
              },
              "indexes": {
                "idx_audit_changed_at": {
                  "schema": "public",
                  "table": "audit",
                  "name": "idx_audit_changed_at",
                  "type": "REGULAR",
                  "method": "btree",
                  "columns": [
                    {
                      "name": "changed_at",
                      "position": 1,
                      "direction": "ASC"
                    }
                  ],
                  "is_concurrent": false,
                  "is_partial": false,
                  "is_expression": false
                },
                "idx_audit_operation": {
                  "schema": "public",
                  "table": "audit",
                  "name": "idx_audit_operation",
                  "type": "REGULAR",
                  "method": "btree",
                  "columns": [
                    {
                      "name": "operation",
                      "position": 1,
                      "direction": "ASC"
                    }
                  ],
                  "is_concurrent": false,
                  "is_partial": false,
                  "is_expression": false
                },
                "idx_audit_username": {
                  "schema": "public",
                  "table": "audit",
                  "name": "idx_audit_username",
                  "type": "REGULAR",
                  "method": "btree",
                  "columns": [
                    {
                      "name": "user_name",
                      "position": 1,
                      "direction": "ASC"
                    }
                  ],
                  "is_concurrent": false,
                  "is_partial": false,
                  "is_expression": false
                }
              },
              "triggers": {},
              "rls_enabled": true,
              "policies": {
                "audit_insert_system": {
                  "schema": "public",
                  "table": "audit",
                  "name": "audit_insert_system",
                  "command": "INSERT",
                  "permissive": true,
                  "roles": [
                    "PUBLIC"
                  ],
                  "with_check": "(true)"
                },
                "audit_user_isolation": {
                  "schema": "public",
                  "table": "audit",
                  "name": "audit_user_isolation",
                  "command": "ALL",
                  "permissive": true,
                  "roles": [
                    "PUBLIC"
                  ],
                  "using": "(user_name = CURRENT_USER)"
                }
              },
              "dependencies": null,
              "is_partitioned": false
            },
            "Enabled": true
          }
        ],
        "CommentChanged": false,
        "OldComment": "",
        "NewComment": ""
      }
    },
    {
      "sql": "ALTER TABLE employee ADD COLUMN status employee_status DEFAULT 'active' NOT NULL;",
      "object_type": "table",
      "operation": "alter",
      "object_path": "public.employee",
      "source_change": {
        "Table": {
          "schema": "public",
          "name": "employee",
          "type": "BASE_TABLE",
          "columns": [
            {
              "name": "emp_no",
              "position": 1,
              "data_type": "integer",
              "is_nullable": false,
              "default_value": "nextval('employee_emp_no_seq'::regclass)"
            },
            {
              "name": "birth_date",
              "position": 2,
              "data_type": "date",
              "is_nullable": false
            },
            {
              "name": "first_name",
              "position": 3,
              "data_type": "text",
              "is_nullable": false
            },
            {
              "name": "last_name",
              "position": 4,
              "data_type": "text",
              "is_nullable": false
            },
            {
              "name": "gender",
              "position": 5,
              "data_type": "text",
              "is_nullable": false
            },
            {
              "name": "hire_date",
              "position": 6,
              "data_type": "date",
              "is_nullable": false
            },
            {
              "name": "status",
              "position": 7,
              "data_type": "employee_status",
              "is_nullable": false,
              "default_value": "'active'"
            }
          ],
          "constraints": {
            "employee_gender_check": {
              "schema": "public",
              "table": "employee",
              "name": "employee_gender_check",
              "type": "CHECK",
              "columns": [
                {
                  "name": "gender",
                  "position": 0
                }
              ],
              "check_clause": "CHECK (gender IN ('M', 'F'))"
            },
            "employee_pkey": {
              "schema": "public",
              "table": "employee",
              "name": "employee_pkey",
              "type": "PRIMARY_KEY",
              "columns": [
                {
                  "name": "emp_no",
                  "position": 1
                }
              ]
            }
          },
          "indexes": {
            "idx_employee_hire_date": {
              "schema": "public",
              "table": "employee",
              "name": "idx_employee_hire_date",
              "type": "REGULAR",
              "method": "btree",
              "columns": [
                {
                  "name": "hire_date",
                  "position": 1,
                  "direction": "ASC"
                }
              ],
              "is_concurrent": false,
              "is_partial": false,
              "is_expression": false
            }
          },
          "triggers": {},
          "rls_enabled": false,
          "policies": {},
          "dependencies": null,
          "is_partitioned": false
        },
        "AddedColumns": [
          {
            "name": "status",
            "position": 7,
            "data_type": "employee_status",
            "is_nullable": false,
            "default_value": "'active'"
          }
        ],
        "DroppedColumns": [],
        "ModifiedColumns": [],
        "AddedConstraints": [],
        "DroppedConstraints": [],
        "AddedIndexes": [],
        "DroppedIndexes": [],
        "ModifiedIndexes": [],
        "AddedTriggers": [],
        "DroppedTriggers": [],
        "ModifiedTriggers": [],
        "AddedPolicies": [],
        "DroppedPolicies": [],
        "ModifiedPolicies": [],
        "RLSChanges": [],
        "CommentChanged": false,
        "OldComment": "",
        "NewComment": ""
      }
    }
  ]
}